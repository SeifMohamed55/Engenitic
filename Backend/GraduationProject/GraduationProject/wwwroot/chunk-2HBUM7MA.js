import{a as P}from"./chunk-KCRSIWVY.js";import{a as j,b as f,c as z,d as U,e as N,f as _,h as $,j as Z,k as L,m as k,n as B,o as H,p as J,t as K}from"./chunk-W3D5FJDG.js";import{l as A}from"./chunk-T3YITE6W.js";import{c as O}from"./chunk-CGPJEUNO.js";import{j as D,r as q}from"./chunk-3CPSLGPY.js";import{Ab as o,Bb as d,Eb as b,Ib as F,Jb as g,R as V,Sb as h,Tb as a,Vb as S,Xa as s,bb as E,gb as G,ha as w,ia as x,j as M,lb as m,sb as p,zb as n}from"./chunk-YOS4OKYA.js";function te(e,i){if(e&1&&(n(0,"div")(1,"p",26),a(2),o()()),e&2){let r=g();s(2),S(" ",r.fileValidationError," ")}}function re(e,i){e&1&&(n(0,"p",26),a(1," invalid email "),o())}function ie(e,i){e&1&&(n(0,"p",26),a(1," email field is required "),o())}function ne(e,i){if(e&1&&(n(0,"div"),m(1,re,2,0,"p",27)(2,ie,2,0,"p",27),o()),e&2){let r,t,l=g();s(),p("ngIf",(r=l.registerForm.get("email"))==null?null:r.getError("email")),s(),p("ngIf",(t=l.registerForm.get("email"))==null?null:t.getError("required"))}}function oe(e,i){e&1&&(n(0,"p",26),a(1," user name field is required "),o())}function le(e,i){if(e&1&&(n(0,"div"),m(1,oe,2,0,"p",27),o()),e&2){let r,t=g();s(),p("ngIf",(r=t.registerForm.get("userName"))==null?null:r.getError("required"))}}function se(e,i){e&1&&(n(0,"p",26),a(1," password field is required "),o())}function ae(e,i){e&1&&(n(0,"p",26),a(1," Password must contain at least: "),d(2,"br"),a(3,"- One digit (0-9) "),d(4,"br"),a(5,"- One lowercase letter (a-z) "),d(6,"br"),a(7,"- One uppercase letter (A-Z) "),d(8,"br"),a(9,"- One special character "),d(10,"br"),a(11,"- Minimum 6 characters "),o())}function pe(e,i){if(e&1&&(n(0,"div"),m(1,se,2,0,"p",27)(2,ae,12,0,"p",27),o()),e&2){let r,t,l=g();s(),p("ngIf",(r=l.registerForm.get("password"))==null?null:r.getError("required")),s(),p("ngIf",(t=l.registerForm.get("password"))==null?null:t.getError("pattern"))}}function me(e,i){e&1&&(n(0,"p",26),a(1," passwords don't match ! "),o())}function ue(e,i){if(e&1&&(n(0,"div"),m(1,me,2,0,"p",27),o()),e&2){let r,t=g();s(),p("ngIf",(r=t.registerForm.get("repassword"))==null?null:r.getError("passwordMiss"))}}function de(e,i){e&1&&(n(0,"div"),d(1,"input",28,4)(3,"input",29,5),o())}function ce(e,i){e&1&&(n(0,"p",26),a(1," Phone number is required if you filled the country code field. "),o())}function ge(e,i){e&1&&(n(0,"p",26),a(1," Country code is required if you filled the phone number field. "),o())}function fe(e,i){e&1&&(n(0,"p",26),a(1," Country code must start with '+' and followed by a number. "),o())}function _e(e,i){e&1&&(n(0,"p",26),a(1," Phone number is invalid. "),o())}function ve(e,i){if(e&1&&(n(0,"div"),m(1,ce,2,0,"p",27)(2,ge,2,0,"p",27)(3,fe,2,0,"p",27)(4,_e,2,0,"p",27),o()),e&2){let r,t,l,u,c=g();s(),p("ngIf",(r=c.registerForm.get("phoneGroup"))==null?null:r.hasError("phoneNumberMissing")),s(),p("ngIf",(t=c.registerForm.get("phoneGroup"))==null?null:t.hasError("countryCodeMissing")),s(),p("ngIf",(l=c.registerForm.get("phoneGroup"))==null?null:l.hasError("countryCodeInvalid")),s(),p("ngIf",(u=c.registerForm.get("phoneGroup"))==null?null:u.hasError("phoneNumberInvalid"))}}function he(e,i){if(e&1&&(n(0,"p",26),a(1),o()),e&2){let r=g(2);s(),S(" ",r.cvErrorMessage," ")}}function ye(e,i){if(e&1){let r=b();n(0,"div",30)(1,"input",31),F("change",function(l){w(r);let u=g();return x(u.handleCv(l))}),o(),m(2,he,2,1,"p",27),o()}if(e&2){let r=g();s(2),p("ngIf",!r.selectedCv)}}var Q=class e{constructor(i,r,t){this._ToastrService=i;this._UserService=r;this._Router=t}destroy$=new M;buttonDisabled=!1;selectedFile=null;fileValidationError=null;cvErrorMessage="";selectedCv=null;ngOnInit(){this._UserService.role.value&&(this._ToastrService.warning("you can't access this page unless you are not logged in"),this._Router.navigate(["/home"]))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}registerForm=new N({phoneGroup:new N({countryCode:new _("",[f.pattern(/^\+\d{1,4}$/)]),phone:new _("",[f.pattern(/^\d{7,15}$/)])},this.phoneNumberValidation),image:new _(""),email:new _("",[f.email,f.required]),userName:new _("",[f.required]),password:new _("",[f.required,f.pattern(/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z\d]).{6,}$/)]),repassword:new _("",[f.required]),role:new _("student")},{validators:[this.confirmPassword,this.phoneNumberValidation]});confirmPassword(i){let r=i.get("password")?.value,t=i.get("repassword")?.value;return r!==t?i.get("repassword")?.setErrors({passwordMiss:!0}):i.get("repassword")?.setErrors(null),null}phoneNumberValidation(i){let r=i.get("countryCode"),t=i.get("phone");return!r?.value&&t?.value?{countryCodeMissing:!0}:r?.value&&!t?.value?{phoneNumberMissing:!0}:r?.invalid?{countryCodeInvalid:!0}:r?.invalid?{countryCodeInvalid:!0}:t?.invalid?{phoneNumberInvalid:!0}:null}onFileChange(i){let r=i.target;if(this.fileValidationError=null,r.files&&r.files.length>0){let t=r.files[0];this.selectedFile=t;let l=["image/jpg","image/png","image/jpeg"],u=2*1024*1024;if(!l.includes(this.selectedFile.type)){this.selectedFile=null,this.fileValidationError="invalid image type";return}if(this.selectedFile.size>u){this.fileValidationError="image size must be less than 2MB",this.selectedFile=null;return}}else this.selectedFile=null}handleCv(i){let t=i.target;if(this.cvErrorMessage="",t.files){let l=t.files[0];if(l.size>5242880){this.cvErrorMessage="file size must be below 5MB";return}if(!l.type.includes("application/pdf")){this.cvErrorMessage="file type must be pdf";return}this.selectedCv=l}else{this.cvErrorMessage="select a file please";return}}registerSubmit(){if(this.buttonDisabled=!0,this.registerForm.valid)if(this.registerForm.get("role")?.value==="instructor"&&this.selectedCv||this.registerForm.get("role")?.value!=="instructor"){let i=new FormData;i.append("username",this.registerForm.get("userName")?.value),i.append("email",this.registerForm.get("email")?.value),i.append("password",this.registerForm.get("password")?.value),i.append("confirmPassword",this.registerForm.get("repassword")?.value),i.append("phoneNumber",this.registerForm.get("phoneGroup")?.get("phone")?.value),i.append("phoneRegion",this.registerForm.get("phoneGroup")?.get("countryCode")?.value),i.append("role",this.registerForm.get("role")?.value),this.selectedFile&&i.append("image",this.selectedFile),this.selectedCv&&i.append("cv",this.selectedCv),this._UserService.registerData(i).pipe(V(this.destroy$)).subscribe({next:r=>{this._ToastrService.success(r.message)},error:r=>{r.error.message?this._ToastrService.error(r.error.message):this._ToastrService.error("an error has during connecting to the server occured try again later")}})}else this.cvErrorMessage="cv field is required";else this.registerForm.markAllAsTouched();this.buttonDisabled=!1}static \u0275fac=function(r){return new(r||e)(E(A),E(P),E(O))};static \u0275cmp=G({type:e,selectors:[["app-register"]],decls:39,vars:10,consts:[["email",""],["userName",""],["password",""],["repassword",""],["countryCode",""],["phoneNumber",""],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-10","items-center","lg:items-start","w-full","container","pt-7"],[1,"flex","justify-between","items-start","flex-col","h-full",3,"ngSubmit","formGroup"],["placeholder","select an image","type","file","accept","image/*","formControlName","image",1,"mb-3","custom-file-input","font-display","lowercase",3,"change"],[1,"font-regular","font-normal","ps-3"],[4,"ngIf"],["type","email","placeholder","  Email ...","formControlName","email",1,"engenitic-input","my-3"],["type","text","placeholder","  User Name ...","formControlName","userName",1,"engenitic-input","my-3"],["type","password","placeholder","  Password ...","formControlName","password",1,"engenitic-input","my-3"],["type","password","placeholder"," Confirm Password ...","formControlName","repassword",1,"engenitic-input","my-3"],["formGroupName","phoneGroup",1,"grid","grid-cols-2","lg:grid-cols-4","my-3","lg:gap-12","w-full"],["type","text","id","country-code","placeholder"," +20  (optional) ","formControlName","countryCode",1,"engenitic-input"],["type","tel","placeholder","  Phone Number ...   (optional)","formControlName","phone",1,"engenitic-input","lg:col-span-3"],[1,"font-regular","text-normal","pe-5"],["title","role","formControlName","role",1,"my-3","rounded","font-regular","py-3"],["value","student"],["value","instructor"],["class","py-3 w-full",4,"ngIf"],["type","submit",1,"engenitic-button","hover:enginitic-main-color","hover:text-white",3,"disabled"],[1,"w-full","flex","py-10","order-first","lg:order-last","justify-center"],["src","./assets/images/register-main-pic.png","alt","register picture",1,"w-[400px]","h-[400px]","lg:ml-auto"],[1,"text-normal","font-regular","text-red-500"],["class","text-normal font-regular text-red-500",4,"ngIf"],["type","text","id","country-code","placeholder","+20 (optional)","formControlName","countryCode",1,"engenitic-input","me-5"],["type","tel","placeholder","Phone Number ... (optional)","formControlName","phone",1,"engenitic-input","col-span-3"],[1,"py-3","w-full"],["placeholder","select your cv","type","file","accept","application/pdf",1,"mb-3","custom-file-input","font-display","lowercase","w-full",3,"change"]],template:function(r,t){if(r&1){let l=b();n(0,"main",6)(1,"form",7),F("ngSubmit",function(){return w(l),x(t.registerSubmit())}),n(2,"div")(3,"input",8),F("change",function(c){return w(l),x(t.onFileChange(c))}),o(),n(4,"span",9),a(5,"(optional)"),o()(),m(6,te,3,1,"div",10),d(7,"input",11,0),m(9,ne,3,2,"div",10),d(10,"input",12,1),m(12,le,2,1,"div",10),d(13,"input",13,2),m(15,pe,3,2,"div",10),d(16,"input",14,3),m(18,ue,2,1,"div",10),n(19,"div",15),d(20,"input",16,4)(22,"input",17,5),o(),m(24,de,5,0,"div",10)(25,ve,5,4,"div",10),n(26,"div")(27,"span",18),a(28,"choose user type please : "),o(),n(29,"select",19)(30,"option",20),a(31,"student"),o(),n(32,"option",21),a(33,"instructor"),o()()(),m(34,ye,3,1,"div",22),n(35,"button",23),a(36," submit "),o()(),n(37,"figure",24),d(38,"img",25),o()()}if(r&2){let l,u,c,y,v,C,I,W=h(8),X=h(11),Y=h(14),ee=h(17),T=h(21),R=h(23);s(),p("formGroup",t.registerForm),s(5),p("ngIf",t.fileValidationError),s(3),p("ngIf",((l=t.registerForm.get("email"))==null?null:l.errors)&&(((l=t.registerForm.get("email"))==null?null:l.touched)||W.value.length>0)),s(3),p("ngIf",((u=t.registerForm.get("userName"))==null?null:u.errors)&&(((u=t.registerForm.get("userName"))==null?null:u.touched)||X.value.length>0)),s(3),p("ngIf",((c=t.registerForm.get("password"))==null?null:c.errors)&&(((c=t.registerForm.get("password"))==null?null:c.touched)||Y.value.length>0)),s(3),p("ngIf",((y=t.registerForm.get("repassword"))==null?null:y.errors)&&(((y=t.registerForm.get("repassword"))==null?null:y.touched)||ee.value.length>0)),s(6),p("ngIf",(((v=t.registerForm.get("phone"))==null?null:v.errors)||((v=t.registerForm.get("countryCode"))==null?null:v.errors))&&(((v=t.registerForm.get("countryCode"))==null?null:v.touched)||((v=t.registerForm.get("phone"))==null?null:v.touched)||T.value.length>0||R.value.length>0)),s(),p("ngIf",((C=t.registerForm.get("phoneGroup"))==null?null:C.errors)&&(((C=t.registerForm.get("phoneGroup"))==null?null:C.touched)||T.value.length>0||R.value.length>0)),s(9),p("ngIf",((I=t.registerForm.get("role"))==null?null:I.value)==="instructor"),s(),p("disabled",t.buttonDisabled)}},dependencies:[K,$,H,J,j,B,z,U,Z,k,L,q,D],styles:["#country-code[_ngcontent-%COMP%]{width:80%!important}"]})};export{Q as RegisterComponent};
