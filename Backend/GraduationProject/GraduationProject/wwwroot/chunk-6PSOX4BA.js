import{a as V,b as U,c as z}from"./chunk-A66F6OJO.js";import{a as M}from"./chunk-DAENC3M5.js";import{l as $}from"./chunk-T3YITE6W.js";import{a as k,c as O,d as D,g as F}from"./chunk-CGPJEUNO.js";import{i as T,j,r as A}from"./chunk-3CPSLGPY.js";import{Ab as o,Bb as g,Cb as N,Db as P,Eb as S,I as b,Ib as C,Jb as h,R as l,Sa as y,Tb as c,Vb as p,Xa as a,ac as w,bb as u,cc as L,fc as R,gb as I,ha as v,hc as E,ia as f,j as _,lb as d,s as x,sb as s,zb as n}from"./chunk-YOS4OKYA.js";var q=(i,t,e)=>({itemsPerPage:i,currentPage:t,totalItems:e}),G=i=>["/course-details",i];function H(i,t){if(i&1){let e=S();n(0,"div",6)(1,"h2",7),c(2,"Search Results"),o(),n(3,"button",8),C("click",function(){v(e);let m=h();return f(m.clearSearch())}),g(4,"i",9),c(5," Back to all courses "),o()()}}function J(i,t){if(i&1&&(N(0),n(1,"div",10)(2,"p",11),c(3),o()(),P()),i&2){let e=h();a(3),p(" ",e.isSearchActivated?"No courses found matching your search.":"No courses available at the moment."," ")}}function K(i,t){if(i&1&&(n(0,"div")(1,"div",12)(2,"div",13)(3,"h3",14),c(4),o(),n(5,"p",15),c(6),o(),n(7,"p",15),c(8),o(),n(9,"a",16)(10,"span",17),c(11," View details "),o(),n(12,"span",18),g(13,"i",19),o()()(),n(14,"figure",20),g(15,"img",21),o()()()),i&2){let e=t.$implicit;a(4),p(" ",e.title," "),a(2),p(" ",e.description," "),a(2),p(" Made by: ",e.instructorName," "),a(),s("routerLink",w(6,G,e.id)),a(6),s("src",e.image.imageURL||"./assets/images/course-placeholder.png",y)("alt",e.image.name?e.image.name:"course image")}}function W(i,t){if(i&1){let e=S();n(0,"pagination-controls",22),C("pageChange",function(m){v(e);let Q=h();return f(Q.onPageChange(m))}),o()}i&2&&s("responsive",!0)("maxSize",10)}var B=class i{constructor(t,e,r,m){this._ActivatedRoute=t;this._CoursesService=e;this._ToastrService=r;this._Router=m}isLoading=!1;destroy$=new _;isSearchActivated=!1;currentPage=1;itemsPerPage=10;totalItems=0;courses=[];initialSearchNavigation=!0;ngOnInit(){this.setupSubscriptions()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setupSubscriptions(){x([this._ActivatedRoute.paramMap,this._CoursesService.isSearchActive]).pipe(l(this.destroy$),b((t,e)=>t[0].get("collectionNumber")===e[0].get("collectionNumber")&&t[1]===e[1])).subscribe(([t,e])=>{let r=Number(t.get("collectionNumber"))||1;this.currentPage=r,this.isSearchActivated=e,e?this.handleSearchNavigation(r):this.handleNormalNavigation(r)}),this._CoursesService.currentSearchResults.pipe(l(this.destroy$)).subscribe(t=>{t&&(this.courses=t.data.paginatedList,this.totalItems=t.data.totalItems)})}handleSearchNavigation(t){if(this.initialSearchNavigation&&t!==1){this.initialSearchNavigation=!1,this.navigateToPage(1);return}this.initialSearchNavigation=!1,this.loadSearchData(t)}handleNormalNavigation(t){this.initialSearchNavigation=!0,this.isSearchActivated||this.fetchCourses(t)}loadSearchData(t){this.isLoading=!0,this._CoursesService.searchForCourseCollection(this._CoursesService.currentSearchQuery,t).pipe(l(this.destroy$)).subscribe({next:e=>{this._CoursesService.updateSearchResults(e),this.isLoading=!1},error:e=>{this.handleError(e),this.isLoading=!1}})}fetchCourses(t){this.isLoading=!0,this._CoursesService.coursesOffered(t).pipe(l(this.destroy$)).subscribe({next:e=>{this.courses=e.data.paginatedList,this.totalItems=e.data.totalItems,this.isLoading=!1},error:e=>{this.handleError(e),this.isLoading=!1}})}onPageChange(t){this.navigateToPage(t)}navigateToPage(t){this.currentPage!==t&&this._Router.navigate(["/offered-courses",t],{replaceUrl:!0})}clearSearch(){this._CoursesService.clearSearchResults(),this.initialSearchNavigation=!0,this.currentPage!==1?this.navigateToPage(1):this.fetchCourses(1)}handleError(t){this.isLoading=!1,this._ToastrService.error(t.error?.message||"An error occurred"),this._Router.navigate(["/home"])}static \u0275fac=function(e){return new(e||i)(u(k),u(M),u($),u(O))};static \u0275cmp=I({type:i,selectors:[["app-course"]],decls:7,vars:11,consts:[[1,"py-10"],["class","flex justify-between items-center mb-6",4,"ngIf"],[1,"py-10","grid","grid-cols-1","lg:grid-cols-2","gap-10"],[4,"ngIf"],[4,"ngFor","ngForOf"],["previousLabel","Previous","nextLabel","Next",3,"responsive","maxSize","pageChange",4,"ngIf"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-center","font-display","py-10","text-2xl"],[1,"engenitic-button","flex","items-center","gap-2",3,"click"],[1,"fa-solid","fa-arrow-left"],[1,"text-center","py-10","col-span-full"],[1,"text-lg"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-5","md:gap-10","items-center","border","border-black","rounded-lg","p-5","shadow-container","course"],[1,"h-[250px]","w-full","aspect-[4/5]","flex","justify-between","flex-col","gap-5","md:gap-10","overflow-hidden"],[1,"font-display","text-secondary-header"],[1,"text-normal","font-regular","text-nowrap"],[1,"engenitic-button","text-center","-translate-x-full","course-button","relative","group","inline-block","hover:enginitic-main-color",3,"routerLink"],[1,"transition-opacity","duration-300","opacity-100","group-hover:opacity-0","flex","justify-center","items-center"],[1,"absolute","inset-0","top-0","transition-opacity","duration-300","opacity-0","group-hover:opacity-100","flex","justify-center","items-center"],[1,"fa-solid","fa-arrow-pointer"],[1,"w-full","flex","justify-center","items-center"],["title","course image",1,"w-64","h-64","md:h-full","object-contain","md:object-cover","rounded-lg",3,"src","alt"],["previousLabel","Previous","nextLabel","Next",3,"pageChange","responsive","maxSize"]],template:function(e,r){e&1&&(n(0,"main",0),d(1,H,6,0,"div",1),n(2,"div",2),d(3,J,4,1,"ng-container",3)(4,K,16,8,"div",4),R(5,"paginate"),o(),d(6,W,1,2,"pagination-controls",5),o()),e&2&&(a(),s("ngIf",r.isSearchActivated),a(2),s("ngIf",r.courses.length===0),a(),s("ngForOf",E(5,4,r.courses,L(7,q,r.itemsPerPage,r.currentPage,r.totalItems))),a(2),s("ngIf",r.courses.length>0))},dependencies:[A,T,j,F,D,z,V,U],encapsulation:2})};export{B as CourseComponent};
