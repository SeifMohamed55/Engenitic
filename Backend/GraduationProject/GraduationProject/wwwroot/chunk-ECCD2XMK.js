import{a as D,b as g,c as P,d as U,e as C,f as p,h as j,j as $,k as R,l as J,m as B,q as H,r as S,t as K}from"./chunk-W3D5FJDG.js";import{a as M}from"./chunk-DAENC3M5.js";import{l as G}from"./chunk-T3YITE6W.js";import{i as k,j as O,r as V}from"./chunk-3CPSLGPY.js";import{$b as Q,Ab as i,Bb as f,Eb as I,Ib as _,Jb as m,Nb as A,R as E,Tb as a,Ub as T,Vb as b,Wb as q,Xa as l,bb as y,gb as L,ha as h,ia as w,j as F,lb as v,nc as N,sb as d,zb as o}from"./chunk-YOS4OKYA.js";var Y=()=>["answer_1","answer_2","answer_3","answer_4"];function Z(s,n){s&1&&(o(0,"div",22),a(1," Title is required "),i())}function ee(s,n){s&1&&(o(0,"div",22),a(1," description is required "),i())}function te(s,n){s&1&&(o(0,"div",22),a(1," requirements is required "),i())}function ie(s,n){if(s&1&&(o(0,"p",23),a(1),i()),s&2){let t=m();l(),b(" ",t.fileValidationError," ")}}function re(s,n){s&1&&(o(0,"div",22),a(1," Video URL is required "),i())}function ne(s,n){s&1&&(o(0,"div",22),a(1," level title is required "),i())}function oe(s,n){s&1&&(o(0,"div",22),a(1," level Description is required "),i())}function le(s,n){s&1&&(o(0,"div",22),a(1," Question is required "),i())}function se(s,n){s&1&&(o(0,"div",22),a(1," Answer is required "),i())}function de(s,n){if(s&1){let t=I();o(0,"div")(1,"div",32)(2,"label",26),a(3),i(),f(4,"input",33),o(5,"input",34),_("click",function(){let r=h(t).$implicit,u=m(5);return w(u.setCorrectAnswer(r))}),i(),a(6," Correct "),v(7,se,2,0,"div",6),i()()}if(s&2){let t,e,r=n.$implicit,u=n.index,c=m(2).index,z=m(2).index,x=m();l(),d("formGroupName",r),l(),d("for","answer-"+c+"-"+u),l(),T(r.replace("_"," ")),l(),d("id","answer-"+c+"-"+u),l(),A("title","is answer ",u," correct ?"),d("name","correctAnswer-"+z+"-"+c)("checked",(t=x.answers(r).get("isCorrect"))==null?null:t.value),l(2),d("ngIf",((e=x.answers(r).get("answer"))==null?null:e.invalid)&&((e=x.answers(r).get("answer"))==null?null:e.touched))}}function ae(s,n){if(s&1&&(o(0,"div",25)(1,"div",3)(2,"label",26),a(3),i(),f(4,"input",31),v(5,le,2,0,"div",6),o(6,"h3",14),a(7," Fill answers and choose the correct one "),i(),v(8,de,8,9,"div",20),i()()),s&2){let t,e=m().index,r=m(3);d("formGroupName",e),l(2),d("for","question-"+e),l(),b("Question ",e+1,""),l(),d("id","question-"+e),l(),d("ngIf",((t=r.quizzes.at(e).get("question"))==null?null:t.invalid)&&((t=r.quizzes.at(e).get("question"))==null?null:t.touched)),l(3),d("ngForOf",Q(6,Y))}}function ue(s,n){if(s&1&&(o(0,"div"),v(1,ae,9,7,"div",24),i()),s&2){let t=n.index,e=m(3);l(),d("ngIf",t===e.currentLevelIndexQuiz)}}function ce(s,n){if(s&1){let t=I();o(0,"div",25)(1,"div",3)(2,"label",26),a(3,"Video URL"),i(),f(4,"input",27),v(5,re,2,0,"div",6),i(),o(6,"div",3)(7,"label",26),a(8,"level Title"),i(),f(9,"input",28),v(10,ne,2,0,"div",6),i(),o(11,"div",3)(12,"label",26),a(13,"level Description"),i(),f(14,"input",29),v(15,oe,2,0,"div",6),i(),o(16,"h3",14),a(17,"Quizzes"),i(),o(18,"div",15)(19,"button",16),_("click",function(){h(t);let r=m(2);return w(r.previousLevelQuiz())}),a(20," Previous "),i(),o(21,"span"),a(22),i(),o(23,"button",16),_("click",function(){h(t);let r=m(2);return w(r.nextLevelQuiz())}),a(24," Next "),i(),o(25,"button",17),_("click",function(){h(t);let r=m(2);return w(r.addLevelQuiz())}),a(26," Add Quiz "),i(),o(27,"button",18),_("click",function(){h(t);let r=m(2);return w(r.deleteLevelQuiz())}),a(28," Delete Quiz "),i()(),o(29,"div",30),v(30,ue,2,1,"div",20),i()()}if(s&2){let t,e,r,u=m().index,c=m();d("formGroupName",u),l(2),d("for","videoUrl-"+u),l(2),d("id","videoUrl-"+u),l(),d("ngIf",((t=c.levels.at(u).get("videoUrl"))==null?null:t.invalid)&&((t=c.levels.at(u).get("videoUrl"))==null?null:t.touched)),l(2),d("for","title-for-level-"+u),l(2),d("id","title-for-level-"+u),l(),d("ngIf",((e=c.levels.at(u).get("levelTitle"))==null?null:e.invalid)&&((e=c.levels.at(u).get("levelTitle"))==null?null:e.touched)),l(2),d("for","description-for-level-"+u),l(2),d("id","description-for-level-"+u),l(),d("ngIf",((r=c.levels.at(u).get("levelDescription"))==null?null:r.invalid)&&((r=c.levels.at(u).get("levelDescription"))==null?null:r.touched)),l(4),d("disabled",c.currentLevelIndexQuiz===0),l(3),q("Quiz ",c.currentLevelIndexQuiz+1," of ",c.quizzes.length,""),l(),d("disabled",c.currentLevelIndexQuiz===c.quizzes.length-1),l(4),d("disabled",c.quizzes.length<=1),l(3),d("ngForOf",c.quizzes.controls)}}function me(s,n){if(s&1&&(o(0,"div"),v(1,ce,31,16,"div",24),i()),s&2){let t=n.index,e=m();l(),d("ngIf",t===e.currentLevelIndex)}}var W=class s{constructor(n,t,e){this.cd=n;this._CoursesService=t;this._ToastrService=e}selectedFile=null;fileValidationError=null;currentLevelIndex=0;currentLevelIndexQuiz=0;destroy$=new F;ngOnInit(){this.addLevelCourse()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}addingCourseForm=new C({title:new p("",[g.required]),description:new p("",[g.required]),requirements:new p("",[g.required]),levels:new S([])});addLevelCourse(){let n=new C({videoUrl:new p("",[g.required]),levelTitle:new p("",[g.required]),levelDescription:new p("",[g.required]),quizzes:new S([this.createQuiz()])});this.addingCourseForm.get("levels").push(n),this.currentLevelIndex=this.levels.length-1,this.currentLevelIndexQuiz=this.quizzes.length-1,this.cd.detectChanges()}deleteLevelCourse(){let n=this.levels;n.length>0&&(n.removeAt(this.currentLevelIndex),this.currentLevelIndex=Math.min(this.currentLevelIndex,n.length-1),this.cd.detectChanges()),this.currentLevelIndexQuiz=this.quizzes.length-1}previousLevelCourse(){this.currentLevelIndex>0&&this.currentLevelIndex--,this.currentLevelIndexQuiz=this.quizzes.length-1}nextLevelCourse(){this.currentLevelIndex<this.levels.length-1&&this.currentLevelIndex++,this.currentLevelIndexQuiz=this.quizzes.length-1}createQuiz(){return new C({question:new p("",[g.required]),answer_1:new C({answer:new p("",[g.required]),isCorrect:new p(!1)}),answer_2:new C({answer:new p("",[g.required]),isCorrect:new p(!1)}),answer_3:new C({answer:new p("",[g.required]),isCorrect:new p(!1)}),answer_4:new C({answer:new p("",[g.required]),isCorrect:new p(!1)})})}addLevelQuiz(){let n=this.currentLevel.get("quizzes");n.push(this.createQuiz()),this.currentLevelIndexQuiz=n.length-1,this.cd.detectChanges()}deleteLevelQuiz(){let n=this.quizzes;n.length>0&&(n.removeAt(this.currentLevelIndexQuiz),this.currentLevelIndexQuiz=Math.min(this.currentLevelIndexQuiz,n.length-1),this.cd.detectChanges())}previousLevelQuiz(){this.currentLevelIndexQuiz>0&&this.currentLevelIndexQuiz--}nextLevelQuiz(){this.currentLevelIndexQuiz<this.quizzes.length-1&&this.currentLevelIndexQuiz++}get levels(){return this.addingCourseForm.get("levels")}get currentLevel(){return this.levels.at(this.currentLevelIndex)}get quizzes(){return this.currentLevel.get("quizzes")}get currentQuiz(){return this.quizzes.at(this.currentLevelIndexQuiz)}answers(n){return this.currentQuiz.get(n)}setCorrectAnswer(n){["answer_1","answer_2","answer_3","answer_4"].forEach(t=>{this.answers(t).get("isCorrect")?.setValue(t===n)}),this.validateQuiz(this.currentQuiz)}validateQuiz(n){let t=["answer_1","answer_2","answer_3","answer_4"].some(e=>n.get(e)?.get("isCorrect")?.value);n.setErrors(t?null:{noCorrectAnswer:!0})}onFileChange(n){let t=n.target;if(this.fileValidationError=null,t.files?.length){let e=t.files[0],r=["image/jpg","image/png","image/jpeg"],u=2*1024*1024;if(!r.includes(e.type)){this.fileValidationError="Invalid image type (only JPG/PNG allowed)";return}if(e.size>u){this.fileValidationError="Image size must be less than 2MB";return}this.selectedFile=e}}onSubmit(){let n=this.addingCourseForm.value;if(this.levels.controls.forEach(t=>{t.get("quizzes").controls.forEach(r=>this.validateQuiz(r))}),!this.selectedFile){this.fileValidationError="Course image is required";return}if(this.addingCourseForm.valid){let t=new FormData;this.addingCourseForm.get("title")?.value&&t.append("title",`${this.addingCourseForm.get("title")?.value}`),this.addingCourseForm.get("description")?.value&&t.append("description",`${this.addingCourseForm.get("description")?.value}`),this.addingCourseForm.get("requirements")?.value&&t.append("requirements",`${this.addingCourseForm.get("requirements")?.value}`),this.selectedFile&&t.append("image",this.selectedFile),localStorage.getItem("id")&&t.append("instructorId",localStorage.getItem("id"));let e=n?.levels?.map((r,u)=>({title:r.levelTitle,position:u+1,videoUrl:r.videoUrl,description:r.levelDescription,questions:r.quizzes.map((c,z)=>({questionText:c.question,position:z+1,answers:["answer_1","answer_2","answer_3","answer_4"].map((x,X)=>({answerText:c[x].answer,position:X+1,isCorrect:c[x].isCorrect}))}))}));t.append("Quizes",JSON.stringify(e)),this._CoursesService.addCourse(t).pipe(E(this.destroy$)).subscribe({next:r=>{this._ToastrService.success(r.message)},error:r=>{r.error.message?this._ToastrService.error(r.error.message):this._ToastrService.error("something went wrong try again later")}})}else this.addingCourseForm.markAllAsTouched()}static \u0275fac=function(t){return new(t||s)(y(N),y(M),y(G))};static \u0275cmp=L({type:s,selectors:[["app-instructor-add-course"]],decls:42,vars:11,consts:[[1,"container"],[1,"text-center","text-2xl","sm:text-3xl","lg:text-5xl","xl:text-header","py-10","font-display"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","title"],["type","text","id","title","formControlName","title","required",""],["class","error",4,"ngIf"],["for","description"],["id","description","formControlName","description","required",""],["for","requirements"],["id","requirements","formControlName","requirements","required",""],["for","imageUrl"],["id","imageUrl","type","file","accept","image/*",1,"mb-3","custom-file-input","font-display","lowercase",3,"change"],["class","text-red-500",4,"ngIf"],[1,"py-10","text-center","font-display","text-[40px]"],[1,"flex","md:items-center","flex-col","md:flex-row","gap-4","my-4"],["type","button",1,"btn-secondary",3,"click","disabled"],["type","button",1,"btn-primary",3,"click"],["type","button",1,"bg-red-500","text-white",3,"click","disabled"],["formArrayName","levels"],[4,"ngFor","ngForOf"],["type","submit",1,"btn-primary"],[1,"error"],[1,"text-red-500"],[3,"formGroupName",4,"ngIf"],[3,"formGroupName"],[3,"for"],["type","url","formControlName","videoUrl","required","",3,"id"],["type","text","formControlName","levelTitle","required","",3,"id"],["type","text","formControlName","levelDescription","required","",3,"id"],["formArrayName","quizzes"],["type","text","formControlName","question","required","",3,"id"],[1,"py-5",3,"formGroupName"],["type","text","formControlName","answer","required","",3,"id"],["type","radio",1,"radio-input","my-5",3,"click","title","name","checked"]],template:function(t,e){if(t&1&&(o(0,"main")(1,"div",0)(2,"h1",1),a(3," Course Creation "),i(),o(4,"form",2),_("ngSubmit",function(){return e.onSubmit()}),o(5,"div",3)(6,"label",4),a(7,"Course Title"),i(),f(8,"input",5),v(9,Z,2,0,"div",6),i(),o(10,"div",3)(11,"label",7),a(12,"Course Description"),i(),f(13,"textarea",8),v(14,ee,2,0,"div",6),i(),o(15,"div",3)(16,"label",9),a(17,"Course Requirements"),i(),f(18,"textarea",10),v(19,te,2,0,"div",6),i(),o(20,"div",3)(21,"label",11),a(22,"Course Image"),i(),o(23,"input",12),_("change",function(u){return e.onFileChange(u)}),i(),v(24,ie,2,1,"p",13),i(),o(25,"h2",14),a(26,"Course Levels"),i(),o(27,"div",15)(28,"button",16),_("click",function(){return e.previousLevelCourse()}),a(29," Previous "),i(),o(30,"span"),a(31),i(),o(32,"button",16),_("click",function(){return e.nextLevelCourse()}),a(33," Next "),i(),o(34,"button",17),_("click",function(){return e.addLevelCourse()}),a(35," Add Level "),i(),o(36,"button",18),_("click",function(){return e.deleteLevelCourse()}),a(37," Delete Level "),i()(),o(38,"div",19),v(39,me,2,1,"div",20),i(),o(40,"button",21),a(41,"Create Course"),i()()()()),t&2){let r,u,c;l(4),d("formGroup",e.addingCourseForm),l(5),d("ngIf",((r=e.addingCourseForm.get("title"))==null?null:r.invalid)&&((r=e.addingCourseForm.get("title"))==null?null:r.touched)),l(5),d("ngIf",((u=e.addingCourseForm.get("description"))==null?null:u.invalid)&&((u=e.addingCourseForm.get("description"))==null?null:u.touched)),l(5),d("ngIf",((c=e.addingCourseForm.get("requirements"))==null?null:c.invalid)&&((c=e.addingCourseForm.get("requirements"))==null?null:c.touched)),l(5),d("ngIf",e.fileValidationError),l(4),d("disabled",e.currentLevelIndex===0),l(3),q("Level ",e.currentLevelIndex+1," of ",e.levels.length,""),l(),d("disabled",e.currentLevelIndex===e.levels.length-1),l(4),d("disabled",e.levels.length<=1),l(3),d("ngForOf",e.levels.controls)}},dependencies:[K,j,D,P,U,H,$,B,R,J,V,k,O],styles:[".form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:600;color:#333}.error[_ngcontent-%COMP%]{color:#dc2626;font-size:.875rem;margin-top:.25rem}input[type=text][_ngcontent-%COMP%], input[type=url][_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #ddd;border-radius:4px;font-size:1rem}textarea[_ngcontent-%COMP%]{min-height:100px;resize:vertical}button[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:4px;transition:background-color .2s}.btn-primary[_ngcontent-%COMP%]{background-color:#2563eb;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#1d4ed8}.btn-secondary[_ngcontent-%COMP%]{background-color:#6b7280;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#4b5563}.level-navigation[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin:1rem 0}.level-indicator[_ngcontent-%COMP%]{font-weight:600;color:#4b5563}.error-message[_ngcontent-%COMP%]{color:#dc2626;font-size:.875rem;margin-top:.25rem}.preview-image[_ngcontent-%COMP%]{max-width:200px;margin-top:1rem;border-radius:4px}"]})};export{W as InstructorAddCourseComponent};
